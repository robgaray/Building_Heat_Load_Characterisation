% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Heat Load Analysis},
  pdfauthor={Roberto Garay Martinez},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Heat Load Analysis}
\author{Roberto Garay Martinez}
\date{2023-03-02}

\begin{document}
\maketitle

This R project performs the analysis of the heat load patterns of a
building

The sample data provided is a 1-year data for a multi-rise building
connected to the District Heating Network in Tartu (Estonia). The data
consists of hourly values of heat load, ambient temperature and solar
radiation over an horizontal plane. The data sources are: GREN EESTI
(heat load) and the UNIVERSITY OF TARTU (weather data)

Many inspection routines are available in this notebook. Some of them
are inactive for conciseness, but can be uncomented and used by the
reader.

\hypertarget{initiation}{%
\section{Initiation}\label{initiation}}

Get the working directory. This is specific to each computer. Indicates
where the R project is stored locally All other file routes will be
built in relation to this

\hypertarget{data-inspection}{%
\section{Data Inspection}\label{data-inspection}}

Execution not strictly required

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{names}\NormalTok{(Dat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "DATE"              "DATE_year"         "DATE_month_year"  
##  [4] "DATE_week_year"    "DATE_day_year"     "DATE_day_month"   
##  [7] "DATE_day_week"     "DATE_hour_year"    "DATE_hour_week"   
## [10] "DATE_hour_day"     "DATE_weekday"      "Holiday"          
## [13] "Temperature"       "Solar.Irradiation" "Power"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{head}\NormalTok{(Dat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                  DATE DATE_year DATE_month_year DATE_week_year DATE_day_year
## 1 2019-01-01 00:00:00      2019               1              0             1
## 2 2019-01-01 01:00:00      2019               1              0             1
## 3 2019-01-01 02:00:00      2019               1              0             1
## 4 2019-01-01 03:00:00      2019               1              0             1
## 5 2019-01-01 04:00:00      2019               1              0             1
## 6 2019-01-01 05:00:00      2019               1              0             1
##   DATE_day_month DATE_day_week DATE_hour_year DATE_hour_week DATE_hour_day
## 1              1             3              0             48             0
## 2              1             3              1             49             1
## 3              1             3              2             50             2
## 4              1             3              3             51             3
## 5              1             3              4             52             4
## 6              1             3              5             53             5
##   DATE_weekday Holiday Temperature Solar.Irradiation Power
## 1         TRUE     YES       -1.15              4.21  27.5
## 2         TRUE     YES       -0.94              4.23  30.0
## 3         TRUE     YES       -0.80              4.13  26.6
## 4         TRUE     YES       -0.60              4.04  26.9
## 5         TRUE     YES       -0.10              4.93  28.4
## 6         TRUE     YES       -0.12              5.11  26.5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
  \CommentTok{\# tail(Dat)}
  \CommentTok{\# summary(Dat)}
  
  \CommentTok{\# Power vs time}
\NormalTok{  var}\OtherTok{\textless{}{-}}\StringTok{"Power"}
\NormalTok{  week\_list}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{20}\NormalTok{)}
\NormalTok{  month\_list}\OtherTok{=}\FunctionTok{c}\NormalTok{()}
  
  \FunctionTok{RG\_inspect\_data}\NormalTok{(Dat,var, week\_list, month\_list)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in RG_inspect_data(Dat, var, week_list, month_list): list of input
## month list was not provided, the function didn`t plot the months
\end{verbatim}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-1.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/data inspection-2.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/data inspection-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
  \CommentTok{\# Temperature vs time}
\NormalTok{  var}\OtherTok{\textless{}{-}}\StringTok{"Temperature"}
\NormalTok{  week\_list}\OtherTok{=}\FunctionTok{c}\NormalTok{()}
\NormalTok{  month\_list}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{7}\NormalTok{)}
  
  \FunctionTok{RG\_inspect\_data}\NormalTok{(Dat, var, week\_list, month\_list)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in RG_inspect_data(Dat, var, week_list, month_list): list of input week
## list was not provided, the function didn`t plot the weeks
\end{verbatim}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-4.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/data inspection-5.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/data inspection-6.pdf}

\begin{Shaded}
\begin{Highlighting}[]
  \CommentTok{\# Solar Irradiation vs time}
\NormalTok{  var}\OtherTok{\textless{}{-}}\StringTok{"Solar.Irradiation"}
\NormalTok{  week\_list}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{20}\NormalTok{)}
\NormalTok{  month\_list}\OtherTok{=}\FunctionTok{c}\NormalTok{()}
  
  \FunctionTok{RG\_inspect\_data}\NormalTok{(Dat, var, week\_list, month\_list)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in RG_inspect_data(Dat, var, week_list, month_list): list of input
## month list was not provided, the function didn`t plot the months
\end{verbatim}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-7.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/data inspection-8.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/data inspection-9.pdf}

\begin{Shaded}
\begin{Highlighting}[]
  \CommentTok{\# Power vs Temperature}
\NormalTok{  var}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(}\StringTok{"Temperature"}\NormalTok{, }\StringTok{"Power"}\NormalTok{)}
\NormalTok{  week\_list}\OtherTok{=}\FunctionTok{c}\NormalTok{()}
\NormalTok{  month\_list}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{7}\NormalTok{)}
  
  \FunctionTok{RG\_inspect\_data}\NormalTok{(Dat, var, week\_list, month\_list)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in RG_inspect_data(Dat, var, week_list, month_list): list of input week
## list was not provided, the function didn`t plot the weeks
\end{verbatim}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-10.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/data inspection-11.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/data inspection-12.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/data inspection-13.pdf}

\begin{Shaded}
\begin{Highlighting}[]
  \CommentTok{\# Solar Irradiation vs Temperature}
\NormalTok{  var}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(}\StringTok{"Temperature"}\NormalTok{,}\StringTok{"Solar.Irradiation"}\NormalTok{)}
\NormalTok{  week\_list}\OtherTok{=}\FunctionTok{c}\NormalTok{()}
\NormalTok{  month\_list}\OtherTok{=}\FunctionTok{c}\NormalTok{()}
  
  \FunctionTok{RG\_inspect\_data}\NormalTok{(Dat, var, week\_list, month\_list)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in RG_inspect_data(Dat, var, week_list, month_list): list of input week
## list was not provided, the function didn`t plot the weeks

## Warning in RG_inspect_data(Dat, var, week_list, month_list): list of input
## month list was not provided, the function didn`t plot the months
\end{verbatim}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-14.pdf}

\begin{Shaded}
\begin{Highlighting}[]
  \CommentTok{\# Heat Map Hour\_week/Week\_year}
  \FunctionTok{RG\_HeatMap}\NormalTok{(Dat[,}
                 \FunctionTok{c}\NormalTok{(}\StringTok{"DATE\_hour\_week"}\NormalTok{,}
                   \StringTok{"DATE\_week\_year"}\NormalTok{,}
                   \StringTok{"Power"}\NormalTok{)}
\NormalTok{  ])}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-15.pdf}

\begin{Shaded}
\begin{Highlighting}[]
  \CommentTok{\# Summary, Power \& Temperature, per month}
  \FunctionTok{RG\_Summary}\NormalTok{(Dat,}\StringTok{"Power"}\NormalTok{,}\StringTok{"DATE\_month\_year"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-16.pdf}

\begin{verbatim}
##             total         1         2        3         4        5         6
## Min.      0.00000  23.70000  19.60000   4.8000   0.00000  0.00000  0.000000
## 1st Qu.   6.10000  44.40000  40.45000  32.1000  13.20000  2.60000  0.100000
## Median   25.35000  61.10000  50.80000  44.7000  26.05000 12.15000  1.950000
## Mean     35.42604  80.54288  67.66086  56.7664  31.06379 15.58616  3.823677
## 3rd Qu.  47.40000  95.10000  97.30000  71.3000  37.57500 22.80000  7.300000
## Max.    269.20000 269.20000 185.20000 183.1000 135.10000 99.00000 29.000000
##                7         8         9        10        11        12
## Min.     0.00000  0.000000   0.00000   5.10000   9.40000  14.90000
## 1st Qu.  0.10000  0.100000   2.40000  21.52500  27.47500  27.92500
## Median   2.40000  1.950000  10.70000  31.45000  41.55000  36.55000
## Mean     4.68033  4.259426  16.10377  42.15688  54.71611  51.21968
## 3rd Qu.  9.60000 10.000000  22.52500  52.40000  69.75000  53.82500
## Max.    55.90000 22.100000 172.50000 137.20000 209.00000 197.40000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{RG\_Summary}\NormalTok{(Dat,}\StringTok{"Temperature"}\NormalTok{,}\StringTok{"DATE\_month\_year"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-17.pdf}

\begin{verbatim}
##              total          1          2          3         4       5        6
## Min.    -19.510000 -19.510000 -9.5900000 -10.500000 -2.820000 -0.8200  6.56000
## 1st Qu.   0.880000  -8.227500 -1.9125000  -1.250000  2.787500  8.1575 15.39500
## Median    6.180000  -5.110000  0.3000000   1.800000  7.380000 11.1250 18.42000
## Mean      7.458668  -5.683091 -0.2002083   1.210243  8.076267 11.6180 18.79432
## 3rd Qu.  14.420000  -2.860000  1.9525000   3.790000 12.470000 14.7950 21.70000
## Max.     30.240000   2.830000  7.4400000  11.450000 23.630000 27.0300 29.08000
##                7        8        9        10        11        12
## Min.     7.23000  6.89000 -0.30000 -4.340000 -7.480000 -5.290000
## 1st Qu. 12.94000 14.34000  8.47250  1.505000  0.027500  0.150000
## Median  15.62000 16.47000 11.49500  5.055000  3.395000  1.850000
## Mean    16.43696 16.77443 11.96828  5.252821  2.554972  1.790903
## 3rd Qu. 19.30500 19.52250 15.20500  9.382500  5.182500  4.087500
## Max.    30.24000 26.00000 25.32000 14.330000 11.170000  8.900000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
  \CommentTok{\# Summary, Power \& Temperature, per day of the week }
  \FunctionTok{RG\_Summary}\NormalTok{(Dat,}\StringTok{"Power"}\NormalTok{,}\StringTok{"DATE\_day\_week"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-18.pdf}

\begin{verbatim}
##             total        1         2         3         4         5         6
## Min.      0.00000  0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
## 1st Qu.   6.10000  5.90000   6.85000   6.57500   7.10000   6.50000   5.07500
## Median   25.35000 19.80000  26.00000  26.80000  29.10000  28.80000  27.70000
## Mean     35.42604 22.15591  39.15054  40.77026  41.17763  40.13037  40.53671
## 3rd Qu.  47.40000 34.50000  54.15000  53.55000  56.45000  55.42500  56.80000
## Max.    269.20000 86.10000 218.90000 269.20000 207.50000 206.40000 231.30000
##               7
## Min.     0.0000
## 1st Qu.  5.4000
## Median  22.6000
## Mean    23.8057
## 3rd Qu. 37.9000
## Max.    90.1000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
  \CommentTok{\# Summary, Power \& Temperature, per hour of the day}
  \FunctionTok{RG\_Summary}\NormalTok{(Dat,}\StringTok{"Power"}\NormalTok{,}\StringTok{"DATE\_hour\_day"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-19.pdf}

\begin{verbatim}
##             total       0        1        2        3         4        5
## Min.      0.00000  0.0000  0.00000  0.00000  0.00000   0.00000  0.00000
## 1st Qu.   6.10000  5.4750  5.17500  6.30000  8.42500   6.32500  7.80000
## Median   25.35000 19.5500 19.70000 21.30000 22.95000  22.40000 23.20000
## Mean     35.42604 21.5625 21.62244 22.60313 23.02267  23.45896 23.53811
## 3rd Qu.  47.40000 32.2250 32.97500 35.05000 34.90000  36.70000 36.00000
## Max.    269.20000 82.3000 83.10000 85.60000 83.10000 100.30000 80.80000
##                6         7         8         9        10        11       12
## Min.     0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.0000
## 1st Qu.  6.72500   4.52500   7.42500   7.50000   8.95000   3.85000   9.6000
## Median  23.55000  28.10000  30.55000  36.40000  38.40000  32.10000  33.2500
## Mean    24.01437  29.52686  32.52314  59.19314  56.49829  53.23561  52.2983
## 3rd Qu. 37.20000  44.90000  50.65000 109.82500 103.35000  98.15000  95.0250
## Max.    87.10000 100.80000 146.60000 269.20000 260.60000 248.70000 247.6000
##                13        14        15        16        17        18        19
## Min.      0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
## 1st Qu.   7.47500   6.60000   4.67500   6.72500   5.70000   4.55000   6.20000
## Median   29.70000  31.30000  31.30000  29.80000  29.40000  24.60000  26.40000
## Mean     51.44943  50.32586  50.15511  49.84091  45.03476  29.96553  29.84274
## 3rd Qu.  93.27500  91.62500  89.75000  88.60000  77.50000  48.85000  49.25000
## Max.    244.60000 240.20000 218.40000 226.10000 200.20000 112.10000 106.50000
##                20        21       22       23
## Min.      0.00000   0.00000  0.00000  0.00000
## 1st Qu.   3.40000   6.15000  3.65000  4.70000
## Median   25.60000  27.80000 14.60000 18.60000
## Mean     29.11563  29.80597 20.35625 20.80114
## 3rd Qu.  47.75000  48.42500 34.12500 32.70000
## Max.    125.70000 118.90000 82.20000 90.30000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
  \CommentTok{\# RG\_Summary(Dat,"Temperature","DATE\_hour\_day")}
  
  \CommentTok{\# Same as preceding, but only for winter months}
\NormalTok{  subset\_Dat}\OtherTok{\textless{}{-}}\NormalTok{Dat[Dat}\SpecialCharTok{$}\NormalTok{DATE\_month\_year }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{12}\NormalTok{),]}
  \FunctionTok{RG\_Summary}\NormalTok{(subset\_Dat,}\StringTok{"Power"}\NormalTok{,}\StringTok{"DATE\_month\_year"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-20.pdf}

\begin{verbatim}
##             total         1         2        3        11        12
## Min.      4.80000  23.70000  19.60000   4.8000   9.40000  14.90000
## 1st Qu.  33.30000  44.40000  40.45000  32.1000  27.47500  27.92500
## Median   46.90000  61.10000  50.80000  44.7000  41.55000  36.55000
## Mean     62.13222  80.54288  67.66086  56.7664  54.71611  51.21968
## 3rd Qu.  78.05000  95.10000  97.30000  71.3000  69.75000  53.82500
## Max.    269.20000 269.20000 185.20000 183.1000 209.00000 197.40000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{RG\_Summary}\NormalTok{(subset\_Dat,}\StringTok{"Temperature"}\NormalTok{,}\StringTok{"DATE\_month\_year"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-21.pdf}

\begin{verbatim}
##                total          1          2          3        11        12
## Min.    -19.51000000 -19.510000 -9.5900000 -10.500000 -7.480000 -5.290000
## 1st Qu.  -3.04000000  -8.227500 -1.9125000  -1.250000  0.027500  0.150000
## Median    0.57000000  -5.110000  0.3000000   1.800000  3.395000  1.850000
## Mean     -0.08221608  -5.683091 -0.2002083   1.210243  2.554972  1.790903
## 3rd Qu.   3.19000000  -2.860000  1.9525000   3.790000  5.182500  4.087500
## Max.     11.45000000   2.830000  7.4400000  11.450000 11.170000  8.900000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{RG\_Summary}\NormalTok{(subset\_Dat,}\StringTok{"Power"}\NormalTok{,}\StringTok{"DATE\_day\_week"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-22.pdf}

\begin{verbatim}
##             total        1         2         3        4        5         6
## Min.      4.80000 11.70000  11.80000  14.70000   9.4000  12.1000  15.50000
## 1st Qu.  33.30000 27.10000  35.10000  34.30000  40.7250  38.4500  36.10000
## Median   46.90000 35.50000  53.35000  51.10000  56.7500  54.8500  54.85000
## Mean     62.13222 37.55256  68.74782  71.74877  74.1502  71.9012  71.64564
## 3rd Qu.  78.05000 46.00000  99.25000 103.40000 111.0250 101.9000  95.42500
## Max.    269.20000 86.10000 218.90000 269.20000 207.5000 206.4000 231.30000
##                7
## Min.     4.80000
## 1st Qu. 29.75000
## Median  39.00000
## Mean    40.43795
## 3rd Qu. 48.80000
## Max.    90.10000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{RG\_Summary}\NormalTok{(subset\_Dat,}\StringTok{"Power"}\NormalTok{,}\StringTok{"DATE\_hour\_day"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/data inspection-23.pdf}

\begin{verbatim}
##             total        0        1        2        3         4        5
## Min.      4.80000 12.90000 11.80000 12.70000 13.70000  11.70000 12.40000
## 1st Qu.  33.30000 26.75000 26.10000 27.65000 27.47500  28.65000 29.65000
## Median   46.90000 34.50000 34.40000 35.60000 36.20000  38.00000 37.70000
## Mean     62.13222 37.47483 36.86623 38.05497 38.20933  39.36424 38.69139
## 3rd Qu.  78.05000 46.10000 44.25000 46.55000 46.42500  47.10000 46.75000
## Max.    269.20000 82.30000 83.10000 85.60000 83.10000 100.30000 80.80000
##                6         7         8        9        10        11        12
## Min.    12.50000  15.50000  17.60000  19.4000  18.80000  16.30000  13.70000
## 1st Qu. 30.05000  38.30000  41.00000  45.6000  45.80000  42.80000  41.95000
## Median  38.60000  48.40000  51.85000 111.3000 103.50000 101.90000  96.90000
## Mean    40.11589  50.97086  54.10867 103.2477  96.71854  95.62583  92.46424
## 3rd Qu. 48.85000  64.40000  62.60000 138.6000 131.65000 129.90000 128.70000
## Max.    87.10000 100.80000 146.60000 269.2000 260.60000 248.70000 247.60000
##                13        14        15        16        17        18        19
## Min.     13.10000   4.80000   4.90000  15.30000  18.60000  17.70000  18.80000
## 1st Qu.  41.35000  39.60000  40.95000  42.67500  41.35000  40.05000  39.75000
## Median   99.10000  93.80000  95.40000  90.00000  83.00000  51.00000  50.50000
## Mean     92.10464  90.27152  91.76159  91.37467  81.61067  52.99073  52.59934
## 3rd Qu. 127.40000 124.70000 126.75000 128.55000 110.52500  65.00000  62.10000
## Max.    244.60000 240.20000 218.40000 226.10000 200.20000 112.10000 106.50000
##                20        21       22     23
## Min.     19.10000  13.60000  9.40000 12.100
## 1st Qu.  39.40000  38.95000 28.55000 26.600
## Median   49.70000  50.80000 36.20000 34.250
## Mean     52.29868  51.60132 36.51391 36.072
## 3rd Qu.  62.70000  62.60000 45.45000 44.050
## Max.    125.70000 118.90000 82.20000 90.300
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
  \CommentTok{\# RG\_Summary(subset\_Dat,"Temperature","DATE\_hour\_day")}
  
  \FunctionTok{rm}\NormalTok{ (month\_list, var, week\_list, subset\_Dat)}
\end{Highlighting}
\end{Shaded}

\hypertarget{insight}{%
\subsection{Insight}\label{insight}}

Some data is missing around week 40. Also (from the heatmap) it seems
that the initiation day of the week is shifted.

Heat load depends on outdoor temperature and solar irradiation Main
dependency on temperature (as temperature and solar irradiation are
partially correlated)

There is a minimum heat load during the hot/summer months There is a
linear heat load vs temperature period in the cold/winter months There
is an intermediate period in mild/spring/autumn months

Daily periods vary due to a set of facts/schedules (building dependent)
office hours (\textasciitilde9-17h) night setback
(\textasciitilde22-23h) weekly occupation pattern

Overall, two main patterns are identifiable.

\hypertarget{resampled-data}{%
\section{Resampled Data}\label{resampled-data}}

Execution not strictly required

Resampled data to day, week and month the function ``mean'' is used to
ensure that the system calculates meaningful values even with some data
loss

\hypertarget{inspection-of-resampled-data}{%
\subsection{Inspection of resampled
data}\label{inspection-of-resampled-data}}

Execution not strictly required

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{RG\_HeatMap}\NormalTok{(Dat.rs.d[,}
                      \FunctionTok{c}\NormalTok{(}\StringTok{"DATE\_day\_week"}\NormalTok{,}
                        \StringTok{"DATE\_week\_year"}\NormalTok{,}
                        \StringTok{"Power"}\NormalTok{)}
\NormalTok{  ])}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/inspection of resampled data-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{RG\_inspect\_data}\NormalTok{ (Dat.rs.d,}
                   \AttributeTok{Var\_list\_input=}\FunctionTok{c}\NormalTok{(}\StringTok{"Temperature"}\NormalTok{,}\StringTok{"Power"}\NormalTok{),}
                   \AttributeTok{week\_list\_input=}\FunctionTok{c}\NormalTok{(),}
                   \AttributeTok{month\_list\_input=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{11}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in RG_inspect_data(Dat.rs.d, Var_list_input = c("Temperature",
## "Power"), : list of input week list was not provided, the function didn`t plot
## the weeks
\end{verbatim}

\includegraphics{R_Building_analysis_files/figure-latex/inspection of resampled data-2.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/inspection of resampled data-3.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/inspection of resampled data-4.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/inspection of resampled data-5.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/inspection of resampled data-6.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/inspection of resampled data-7.pdf}
\includegraphics{R_Building_analysis_files/figure-latex/inspection of resampled data-8.pdf}

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{RG\_inspect\_data}\NormalTok{ (Dat.rs.w,}
                   \AttributeTok{Var\_list\_input=}\FunctionTok{c}\NormalTok{(}\StringTok{"Temperature"}\NormalTok{,}\StringTok{"Power"}\NormalTok{),}
                   \AttributeTok{week\_list\_input=}\FunctionTok{c}\NormalTok{(),}
                   \AttributeTok{month\_list\_input=}\FunctionTok{c}\NormalTok{()}
\NormalTok{  )  }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in RG_inspect_data(Dat.rs.w, Var_list_input = c("Temperature",
## "Power"), : list of input week list was not provided, the function didn`t plot
## the weeks
\end{verbatim}

\begin{verbatim}
## Warning in RG_inspect_data(Dat.rs.w, Var_list_input = c("Temperature",
## "Power"), : list of input month list was not provided, the function didn`t plot
## the months
\end{verbatim}

\includegraphics{R_Building_analysis_files/figure-latex/inspection of resampled data-9.pdf}

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{RG\_inspect\_data}\NormalTok{ (Dat.rs.m,}
                   \AttributeTok{Var\_list\_input=}\FunctionTok{c}\NormalTok{(}\StringTok{"Temperature"}\NormalTok{,}\StringTok{"Power"}\NormalTok{),}
                   \AttributeTok{week\_list\_input=}\FunctionTok{c}\NormalTok{(),}
                   \AttributeTok{month\_list\_input=}\FunctionTok{c}\NormalTok{()}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in RG_inspect_data(Dat.rs.m, Var_list_input = c("Temperature",
## "Power"), : list of input week list was not provided, the function didn`t plot
## the weeks
\end{verbatim}

\begin{verbatim}
## Warning in RG_inspect_data(Dat.rs.m, Var_list_input = c("Temperature",
## "Power"), : list of input month list was not provided, the function didn`t plot
## the months
\end{verbatim}

\includegraphics{R_Building_analysis_files/figure-latex/inspection of resampled data-10.pdf}

\hypertarget{insight-1}{%
\subsection{Insight}\label{insight-1}}

Daily averaged data allows to see the main trends (except for
intra-daily issues) There is a minimum heat load during the hot/summer
months There is a linear heat load vs temperature period in the
cold/winter months There is an intermediate period in mild/spring/autumn
months

Daily periods vary due to a set of facts/schedules (building dependent)
weekly occupation pattern

In cold months, two sets of linear dependencies against temperature can
be seen. Probably related to weekday / weekend patterns.

Weekly data allows to see the main trends (except for intra-daily \&
inter-daily issues) There is a minimum heat load during the hot/summer
months There is a linear heat load vs temperature period in the
cold/winter months There is an intermediate period in mild/spring/autumn
months

ONLY ONE linear dependency against temperature can be seen (as opposed
to the information with daily data)

Monthly data provides \textasciitilde the same information as weekly
data, but with fewer points.

\hypertarget{initial-changepoint-model-and-outlier-detection}{%
\section{Initial Changepoint model and outlier
detection}\label{initial-changepoint-model-and-outlier-detection}}

A model is trained for the dataset. It consist of a changepoint model
segmented for each hour of the week (168 models) Then the observations
too far from the model are discarded. This process takes in the range of
3 minutes.

\hypertarget{inspection-of-the-changepoint-model}{%
\subsection{Inspection of the changepoint
model}\label{inspection-of-the-changepoint-model}}

Before discarding of outliers

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Changepoint\_plot\_coordinates}\OtherTok{\textless{}{-}}\NormalTok{Changepoint\_Parameters\_summary}

\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x1}\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{50}
\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y1}\OtherTok{\textless{}{-}}\NormalTok{ Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{intercept}\SpecialCharTok{+}\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{slope\_Temp}\SpecialCharTok{*}\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x1}

\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x2}\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\NormalTok{(Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{intercept}\SpecialCharTok{{-}}\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{minimum)}\SpecialCharTok{/}\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{slope\_Temp}
\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y2}\OtherTok{\textless{}{-}}\NormalTok{  Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{minimum}

\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x3}\OtherTok{\textless{}{-}}  \DecValTok{50}
\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y3}\OtherTok{\textless{}{-}}\NormalTok{  Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{minimum}

\FunctionTok{plot}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{50}\NormalTok{,}\DecValTok{50}\NormalTok{),}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FunctionTok{max}\NormalTok{ (Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y1)),}
     \AttributeTok{type=}\StringTok{"n"}\NormalTok{,}
     \AttributeTok{xlab=}\StringTok{"Temperature [C]"}\NormalTok{,}
     \AttributeTok{ylab=}\StringTok{"Heat Load [kWh]"}\NormalTok{)}

\ControlFlowTok{for}\NormalTok{ (ni }\ControlFlowTok{in}\NormalTok{ Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{DATE\_hour\_week)}
\NormalTok{\{}
\NormalTok{  bool}\OtherTok{\textless{}{-}}\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{DATE\_hour\_week}\SpecialCharTok{==}\NormalTok{ni}
\NormalTok{  varX}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x1[bool],Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x2[bool],Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x3[bool])}
\NormalTok{  varY}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y1[bool],Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y2[bool],Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y3[bool])}
  
  \FunctionTok{lines}\NormalTok{ (varX,varY)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/inspection of the changepoint model-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rm}\NormalTok{(Changepoint\_plot\_coordinates, ni, varX, varY, bool)}
\end{Highlighting}
\end{Shaded}

\hypertarget{insight-2}{%
\subsection{Insight}\label{insight-2}}

Overall, the same two main patterns are identified, with some
specificities for each hour.

It seems that for some specific hours, a third pattern can be observed.
Without heat loads for loads above \textasciitilde0ºC. (This only
happens sometimes, based on the genetic algorithm identification
process).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# save.image(paste(WD,"Workspace.RData",sep="/"))}
\CommentTok{\# }
\CommentTok{\# WD\textless{}{-}getwd()}
\CommentTok{\# load(paste(WD,"Workspace.RData",sep="/"))}
\end{Highlighting}
\end{Shaded}

\hypertarget{repair-dataset}{%
\section{Repair dataset}\label{repair-dataset}}

The current dataset only contains observations for those timestamps
where an original observation was available in the dataset. This chunk
of code generates an empty observation for every hour in between the
initial and final timestamps.

The content of the observations is also updated as follows:

\begin{itemize}
\item
  IS\_Outlier: TRUE/FALSE/CORRECTED (only energy is corrected)
\item
  IS\_Missing: TRUE/FALSE/CORRECTED (both energy and climate are
  corrected)
\item
  Power\_Corrected
\end{itemize}

Corrections are performed stepwise.

\hypertarget{interpolation}{%
\subsection{Interpolation}\label{interpolation}}

\textless1h voids, with data available for the -1 .. 1h slot on the
previous and following weeks.

\textless5h voids, with data available for the -5 .. 5h slot on the
previous and following weeks. This is done stepwise. First 2h voids,
then 3h voids,\ldots{}

\hypertarget{insight-3}{%
\subsection{Insight}\label{insight-3}}

In the range of 5\% of data is identified as outliers. The data filling
process are able to reconstruct 30\% of the outlier data. This is mostly
achieved through the 1h void filling process.

\hypertarget{recalculate-changepoint}{%
\section{Recalculate changepoint}\label{recalculate-changepoint}}

Once outliers are discarded and data is (partially) repaired. This
process takes in the range of 3 minutes.

\hypertarget{inspection-of-the-changepoint-model-1}{%
\subsection{Inspection of the changepoint
model}\label{inspection-of-the-changepoint-model-1}}

After discarding of outliers

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Changepoint\_plot\_coordinates}\OtherTok{\textless{}{-}}\NormalTok{Changepoint\_Parameters\_summary\_v2}

\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x1}\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{50}
\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y1}\OtherTok{\textless{}{-}}\NormalTok{ Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{intercept}\SpecialCharTok{+}\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{slope\_Temp}\SpecialCharTok{*}\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x1}

\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x2}\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\NormalTok{(Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{intercept}\SpecialCharTok{{-}}\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{minimum)}\SpecialCharTok{/}\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{slope\_Temp}
\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y2}\OtherTok{\textless{}{-}}\NormalTok{  Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{minimum}

\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x3}\OtherTok{\textless{}{-}}  \DecValTok{50}
\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y3}\OtherTok{\textless{}{-}}\NormalTok{  Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{minimum}

\FunctionTok{plot}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{50}\NormalTok{,}\DecValTok{50}\NormalTok{),}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FunctionTok{max}\NormalTok{ (Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y1)),}
     \AttributeTok{type=}\StringTok{"n"}\NormalTok{,}
     \AttributeTok{xlab=}\StringTok{"Temperature [C]"}\NormalTok{,}
     \AttributeTok{ylab=}\StringTok{"Heat Load [kWh]"}\NormalTok{)}

\ControlFlowTok{for}\NormalTok{ (ni }\ControlFlowTok{in}\NormalTok{ Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{DATE\_hour\_week)}
\NormalTok{\{}
\NormalTok{  bool}\OtherTok{\textless{}{-}}\NormalTok{Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{DATE\_hour\_week}\SpecialCharTok{==}\NormalTok{ni}
\NormalTok{  varX}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x1[bool],Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x2[bool],Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{x3[bool])}
\NormalTok{  varY}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y1[bool],Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y2[bool],Changepoint\_plot\_coordinates}\SpecialCharTok{$}\NormalTok{y3[bool])}
  
  \FunctionTok{lines}\NormalTok{ (varX,varY)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/inspection of the changepoint model 2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rm}\NormalTok{(Changepoint\_plot\_coordinates, ni, varX, varY)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{save.image}\NormalTok{(}\FunctionTok{paste}\NormalTok{(WD,}\StringTok{"Workspace.RData"}\NormalTok{,}\AttributeTok{sep=}\StringTok{"/"}\NormalTok{))}

\NormalTok{WD}\OtherTok{\textless{}{-}}\FunctionTok{getwd}\NormalTok{()}
\FunctionTok{load}\NormalTok{(}\FunctionTok{paste}\NormalTok{(WD,}\StringTok{"Workspace.RData"}\NormalTok{,}\AttributeTok{sep=}\StringTok{"/"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{model-statistics}{%
\section{Model statistics}\label{model-statistics}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{num\_outliers}\OtherTok{\textless{}{-}}\FunctionTok{sum}\NormalTok{(Dat1}\SpecialCharTok{$}\NormalTok{IS\_Outlier)}
\NormalTok{prop\_outliers}\OtherTok{\textless{}{-}}\NormalTok{num\_outliers}\SpecialCharTok{/}\FunctionTok{dim}\NormalTok{(Dat1)[}\DecValTok{1}\NormalTok{]}

\NormalTok{num\_repaired\_1}\OtherTok{\textless{}{-}}\FunctionTok{sum}\NormalTok{(Dat2}\SpecialCharTok{$}\NormalTok{IS\_Repaired)}
\NormalTok{prop\_repaired\_1}\OtherTok{\textless{}{-}}\NormalTok{num\_repaired\_1}\SpecialCharTok{/}\NormalTok{num\_outliers}

\NormalTok{num\_repaired\_2}\OtherTok{\textless{}{-}}\FunctionTok{sum}\NormalTok{(Dat3}\SpecialCharTok{$}\NormalTok{IS\_Repaired)}
\NormalTok{prop\_repaired\_2}\OtherTok{\textless{}{-}}\NormalTok{num\_repaired\_2}\SpecialCharTok{/}\NormalTok{num\_outliers}

\FunctionTok{plot}\NormalTok{(Dat3}\SpecialCharTok{$}\NormalTok{Power,Dat3}\SpecialCharTok{$}\NormalTok{Power\_corrected,}
     \AttributeTok{xlab=}\StringTok{"Power.original [kWh]"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Power.corrected [kWh]"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/model statistics-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(}\FunctionTok{cumsum}\NormalTok{(Dat2}\SpecialCharTok{$}\NormalTok{Power)}\SpecialCharTok{/}\FunctionTok{sum}\NormalTok{(Dat2}\SpecialCharTok{$}\NormalTok{Power),}
     \FunctionTok{cumsum}\NormalTok{(Dat2}\SpecialCharTok{$}\NormalTok{Power\_corrected)}\SpecialCharTok{/}\FunctionTok{sum}\NormalTok{(Dat2}\SpecialCharTok{$}\NormalTok{Power\_corrected),}
     \AttributeTok{xlab=}\StringTok{"Cumulated Energy.original [kWh]"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Cumulated Energy.corrected [kWh]"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/model statistics-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Power\_orig}\OtherTok{\textless{}{-}}\FunctionTok{sum}\NormalTok{(Dat3}\SpecialCharTok{$}\NormalTok{Power)}
\NormalTok{Power\_corrected}\OtherTok{\textless{}{-}}\FunctionTok{sum}\NormalTok{(Dat3}\SpecialCharTok{$}\NormalTok{Power\_corrected)}
\NormalTok{Power\_correction}\OtherTok{\textless{}{-}}\NormalTok{(Power\_corrected}\SpecialCharTok{{-}}\NormalTok{Power\_orig)}\SpecialCharTok{/}\NormalTok{Power\_orig}

\NormalTok{R2\_orig}\OtherTok{\textless{}{-}}\FunctionTok{cor}\NormalTok{(Dat1}\SpecialCharTok{$}\NormalTok{Power\_fitted,Dat1}\SpecialCharTok{$}\NormalTok{Power)}
\NormalTok{RMSE\_orig}\OtherTok{\textless{}{-}}\FunctionTok{rmse}\NormalTok{(Dat1}\SpecialCharTok{$}\NormalTok{Power\_fitted,Dat1}\SpecialCharTok{$}\NormalTok{Power)}
\NormalTok{MAE\_orig}\OtherTok{\textless{}{-}}\FunctionTok{mae}\NormalTok{(Dat1}\SpecialCharTok{$}\NormalTok{Power\_fitted,Dat1}\SpecialCharTok{$}\NormalTok{Power)}
\NormalTok{Power\_orig\_by\_hour}\OtherTok{\textless{}{-}}\FunctionTok{aggregate}\NormalTok{(Power }\SpecialCharTok{\textasciitilde{}}\NormalTok{ DATE\_hour\_day, }\AttributeTok{data=}\NormalTok{Dat1, mean)[,}\DecValTok{2}\NormalTok{]}

\NormalTok{Dat1\_no\_outlier}\OtherTok{\textless{}{-}}\NormalTok{Dat1[}\SpecialCharTok{!}\NormalTok{Dat1}\SpecialCharTok{$}\NormalTok{IS\_Outlier,]}
\NormalTok{R2\_no\_outlier}\OtherTok{\textless{}{-}}\FunctionTok{cor}\NormalTok{(Dat1\_no\_outlier}\SpecialCharTok{$}\NormalTok{Power\_fitted,Dat1\_no\_outlier}\SpecialCharTok{$}\NormalTok{Power)}
\NormalTok{RMSE\_no\_outlier}\OtherTok{\textless{}{-}}\FunctionTok{rmse}\NormalTok{(Dat1\_no\_outlier}\SpecialCharTok{$}\NormalTok{Power\_fitted,Dat1\_no\_outlier}\SpecialCharTok{$}\NormalTok{Power)}
\NormalTok{MAE\_no\_outlier}\OtherTok{\textless{}{-}}\FunctionTok{mae}\NormalTok{(Dat1\_no\_outlier}\SpecialCharTok{$}\NormalTok{Power\_fitted,Dat1\_no\_outlier}\SpecialCharTok{$}\NormalTok{Power)}
\NormalTok{Power\_no\_outlier\_by\_hour}\OtherTok{\textless{}{-}}\FunctionTok{aggregate}\NormalTok{(Power }\SpecialCharTok{\textasciitilde{}}\NormalTok{ DATE\_hour\_day, }\AttributeTok{data=}\NormalTok{Dat1\_no\_outlier, mean)[,}\DecValTok{2}\NormalTok{]}

\NormalTok{Dat3\_repaired}\OtherTok{\textless{}{-}}\NormalTok{Dat3[}\SpecialCharTok{!}\NormalTok{Dat3}\SpecialCharTok{$}\NormalTok{IS\_Outlier}\SpecialCharTok{{-}}\NormalTok{Dat3}\SpecialCharTok{$}\NormalTok{IS\_Repaired,]}
\NormalTok{R2\_repaired}\OtherTok{\textless{}{-}}\FunctionTok{cor}\NormalTok{(Dat3\_repaired}\SpecialCharTok{$}\NormalTok{Power\_fitted,Dat3\_repaired}\SpecialCharTok{$}\NormalTok{Power\_corrected)}
\NormalTok{RMSE\_repaired}\OtherTok{\textless{}{-}}\FunctionTok{rmse}\NormalTok{(Dat3\_repaired}\SpecialCharTok{$}\NormalTok{Power\_fitted,Dat3\_repaired}\SpecialCharTok{$}\NormalTok{Power\_corrected)}
\NormalTok{MAE\_repaired}\OtherTok{\textless{}{-}}\FunctionTok{mae}\NormalTok{(Dat3\_repaired}\SpecialCharTok{$}\NormalTok{Power\_fitted,Dat3\_repaired}\SpecialCharTok{$}\NormalTok{Power\_corrected)}
\NormalTok{Power\_repaired\_by\_hour}\OtherTok{\textless{}{-}}\FunctionTok{aggregate}\NormalTok{(Power\_corrected }\SpecialCharTok{\textasciitilde{}}\NormalTok{ DATE\_hour\_day, }\AttributeTok{data=}\NormalTok{Dat3\_repaired, mean)[,}\DecValTok{2}\NormalTok{]}

\NormalTok{Dat4\_no\_outlier}\OtherTok{\textless{}{-}}\NormalTok{Dat1[}\SpecialCharTok{!}\NormalTok{Dat4}\SpecialCharTok{$}\NormalTok{IS\_Outlier,]}
\NormalTok{R2\_repaired\_retrained}\OtherTok{\textless{}{-}}\FunctionTok{cor}\NormalTok{(Dat4\_no\_outlier}\SpecialCharTok{$}\NormalTok{Power\_fitted,Dat4\_no\_outlier}\SpecialCharTok{$}\NormalTok{Power)}
\NormalTok{RMSE\_repaired\_retrained}\OtherTok{\textless{}{-}}\FunctionTok{rmse}\NormalTok{(Dat4\_no\_outlier}\SpecialCharTok{$}\NormalTok{Power\_fitted,Dat4\_no\_outlier}\SpecialCharTok{$}\NormalTok{Power)}
\NormalTok{MAE\_repaired\_retrained}\OtherTok{\textless{}{-}}\FunctionTok{mae}\NormalTok{(Dat4\_no\_outlier}\SpecialCharTok{$}\NormalTok{Power\_fitted,Dat4\_no\_outlier}\SpecialCharTok{$}\NormalTok{Power)}
\NormalTok{Power\_repaired\_retrained\_by\_hour}\OtherTok{\textless{}{-}}\FunctionTok{aggregate}\NormalTok{(Power }\SpecialCharTok{\textasciitilde{}}\NormalTok{ DATE\_hour\_day, }\AttributeTok{data=}\NormalTok{Dat4\_no\_outlier, mean)[,}\DecValTok{2}\NormalTok{]}


\NormalTok{R2}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(R2\_orig, R2\_no\_outlier, R2\_repaired, R2\_repaired\_retrained)}
\NormalTok{RMSE}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(RMSE\_orig, RMSE\_no\_outlier, RMSE\_repaired, RMSE\_repaired\_retrained)}
\NormalTok{MAE}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(MAE\_orig, MAE\_no\_outlier, MAE\_repaired, MAE\_repaired\_retrained)}

\NormalTok{legend }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Orig."}\NormalTok{, }\StringTok{"Out.Rm"}\NormalTok{, }\StringTok{".Rep"}\NormalTok{, }\StringTok{"Retr"}\NormalTok{)}

\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\FunctionTok{barplot}\NormalTok{(R2,     }\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{),     }\AttributeTok{names.arg=}\NormalTok{legend,     }\AttributeTok{ylab=}\StringTok{"R2"}\NormalTok{)}
\FunctionTok{barplot}\NormalTok{(RMSE,   }\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{20}\NormalTok{),    }\AttributeTok{names.arg=}\NormalTok{legend,     }\AttributeTok{ylab=}\StringTok{"RMSE"}\NormalTok{)}
\FunctionTok{barplot}\NormalTok{(MAE,    }\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{),    }\AttributeTok{names.arg=}\NormalTok{legend,     }\AttributeTok{ylab=}\StringTok{"MAE"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/model statistics-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}

\NormalTok{legend}\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Original"}\NormalTok{, }\StringTok{"Outlier Removed"}\NormalTok{, }\StringTok{"Outlier Repaired"}\NormalTok{, }\StringTok{"Retrained"}\NormalTok{)}

\FunctionTok{plot}\NormalTok{(Power\_orig\_by\_hour, }\AttributeTok{type=}\StringTok{"n"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Power, kWh"}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"hour of the day"}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{75}\NormalTok{))}
\FunctionTok{lines}\NormalTok{(Power\_orig\_by\_hour, }\AttributeTok{col=}\StringTok{"black"}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(Power\_no\_outlier\_by\_hour, }\AttributeTok{col=}\StringTok{"red"}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(Power\_repaired\_by\_hour, }\AttributeTok{col=}\StringTok{"green"}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(Power\_repaired\_retrained\_by\_hour, }\AttributeTok{col=}\StringTok{"blue"}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, legend, }\AttributeTok{col=}\FunctionTok{c}\NormalTok{(}\StringTok{"black"}\NormalTok{,}\StringTok{"red"}\NormalTok{,}\StringTok{"green"}\NormalTok{,}\StringTok{"blue"}\NormalTok{),}\AttributeTok{lty=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Building_analysis_files/figure-latex/model statistics-4.pdf}

\hypertarget{insight-4}{%
\subsection{Insight}\label{insight-4}}

(figures are dependent on the parametrization of the changepoint model
identification process)

Power corrections are performed for ca 130 data points. This is a
relatively small number of points. Its impact in the cumulated power
curve is not relevant.

Changepoint models seem to be reasonable ways to model heat load data.
Overall, good performance metrics are achieved in all cases
(R2\textgreater0.9; RMSE\textless15.9, MAE\textless10 in all cases)

Performance is slightly increased when outliers are removed. Outlier
repair and model retraining does not seem to have a significant input.

\end{document}
